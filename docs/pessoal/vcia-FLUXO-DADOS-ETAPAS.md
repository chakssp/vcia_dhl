

```mermaid

graph TB
¬† ¬† %% Estilos
¬† ¬† classDef etapa fill:#3b82f6,stroke:#1e40af,stroke-width:2px,color:#fff
¬† ¬† classDef manager fill:#10b981,stroke:#059669,stroke-width:2px,color:#fff
¬† ¬† classDef storage fill:#f59e0b,stroke:#d97706,stroke-width:2px,color:#fff
¬† ¬† classDef service fill:#8b5cf6,stroke:#6d28d9,stroke-width:2px,color:#fff
  
¬† ¬† %% ETAPA 1: DESCOBERTA
¬† ¬† subgraph E1["üîç ETAPA 1: DESCOBERTA"]
¬† ¬† ¬† ¬† U1[/"üë§ Usu√°rio seleciona diret√≥rios"/]
¬† ¬† ¬† ¬† DM[DiscoveryManager]:::manager
¬† ¬† ¬† ¬† HM[HandleManager]:::manager
¬† ¬† ¬† ¬† FS[File System Access API]:::service
¬† ¬† ¬† ¬† U1 --> DM
¬† ¬† ¬† ¬† DM --> FS
¬† ¬† ¬† ¬† FS --> HM
¬† ¬† end
  
¬† ¬† %% ETAPA 2: PR√â-AN√ÅLISE
¬† ¬† subgraph E2["üìä ETAPA 2: PR√â-AN√ÅLISE"]
¬† ¬† ¬† ¬† FM[FilterManager]:::manager
¬† ¬† ¬† ¬† PU[PreviewUtils]:::service
¬† ¬† ¬† ¬† FR[FileRenderer]:::manager
¬† ¬† ¬† ¬† FM --> PU
¬† ¬† ¬† ¬† PU --> FR
¬† ¬† end
  
¬† ¬† %% ETAPA 3: AN√ÅLISE IA
¬† ¬† subgraph E3["ü§ñ ETAPA 3: AN√ÅLISE IA"]
¬† ¬† ¬† ¬† AM[AnalysisManager]:::manager
¬† ¬† ¬† ¬† AI[AIAPIManager]:::manager
¬† ¬† ¬† ¬† PM[PromptManager]:::manager
¬† ¬† ¬† ¬† LLM[/"Ollama/OpenAI/etc"/]:::service
¬† ¬† ¬† ¬† AM --> PM
¬† ¬† ¬† ¬† PM --> AI
¬† ¬† ¬† ¬† AI --> LLM
¬† ¬† end
  
¬† ¬† %% ETAPA 4: ORGANIZA√á√ÉO
¬† ¬† subgraph E4["üìÅ ETAPA 4: ORG"]
¬† ¬† ¬† ¬† CM[CategoryManager]:::manager
¬† ¬† ¬† ¬† REM[RAGExportManager]:::manager
¬† ¬† ¬† ¬† ES[EmbeddingService]:::service
¬† ¬† ¬† ¬† QS[QdrantService]:::service
¬† ¬† ¬† ¬† CM --> REM
¬† ¬† ¬† ¬† REM --> ES
¬† ¬† ¬† ¬† ES --> QS
¬† ¬† end
  
¬† ¬† %% ARMAZENAMENTO CENTRAL
¬† ¬† AS[AppState]:::storage
¬† ¬† SC[SessionCache]:::storage
¬† ¬† LS[localStorage]:::storage
¬† ¬† IDB[IndexedDB]:::storage
  ¬† 
  ¬† %% FLUXOS ENTRE ETAPAS
¬† ¬† HM -->|"files[]"| AS
¬† ¬† AS -->|"files[]"| FM
¬† ¬† FR -->|"relevanceScore"| AS
¬† ¬† AS -->|"filtered files"| AM
¬† ¬† LLM -->|"analysisType"| AM
¬† ¬† AM -->|"analyzed=true"| AS
¬† ¬† AS -->|"analyzed files"| CM
¬† ¬† QS -->|"inQdrant=true"| AS

¬† ¬† %% CONEX√ïES COM STORAGE
¬† ¬† AS <--> LS
¬† ¬† AS --> SC
¬† ¬† ES --> IDB

¬† ¬† %% EVENTOS
¬† ¬† EB{{EventBus}}:::service
¬† ¬† DM -.->|"FILES_DISCOVERED"| EB
¬† ¬† FM -.->|"FILTERS_CHANGED"| EB
¬† ¬† AM -.->|"ANALYSIS_COMPLETED"| EB
¬† ¬† CM -.->|"CATEGORIES_CHANGED"| EB
¬† ¬† EB -.->|"Notifica componentes"| FR
¬† ¬† EB -.->|"Notifica componentes"| AS

```

---
## üîÑ PIPELINE DE INTEGRA√á√ÉO IA CORRIGIDO
### REGEX
```mermaid

  graph TB
      %% Estilos
      classDef broken fill:#ef4444,stroke:#dc2626,color:#fff
      classDef fixed fill:#10b981,stroke:#059669,color:#fff
      classDef ai fill:#8b5cf6,stroke:#7c3aed,color:#fff
      classDef human fill:#f59e0b,stroke:#d97706,color:#fff
      classDef feedback fill:#3b82f6,stroke:#2563eb,color:#fff

      %% ETAPA 1: DESCOBERTA
      subgraph E1["üîç ETAPA 1: DESCOBERTA INTELIGENTE"]
          D1[Descoberta de Arquivos]
          D2[C√°lculo de Relev√¢ncia]:::fixed
          D3[("Relev√¢ncia + Contexto")]:::fixed
      end

      %% ETAPA 2: PR√â-AN√ÅLISE SEM√ÇNTICA
      subgraph E2["üìä ETAPA 2: PR√â-AN√ÅLISE"]
          P1[Preview Inteligente<br/>5 Segmentos]:::fixed
          P2[An√°lise Estruturada]:::fixed
          P3[("Preview + Relev√¢ncia")]:::fixed
      end

      %% CURADORIA HUMANA
      subgraph CH["üë§ CURADORIA HUMANA"]
          C1[Categoriza√ß√£o Manual]:::human
          C2[("Ground Truth")]:::human
          C3[Boost Relev√¢ncia<br/>1.5 + n√ó0.1]:::fixed
      end

      %% ETAPA 3: AN√ÅLISE IA
      subgraph E3["ü§ñ ETAPA 3: AN√ÅLISE IA"]
          A1[Ollama/LLMs]:::ai
          A2[An√°lise Contextual<br/>com Relev√¢ncia]:::fixed
          A3[Valida√ß√£o por<br/>Ground Truth]:::fixed
      end

      %% SISTEMA SEM√ÇNTICO
      subgraph SS["üß† SISTEMA SEM√ÇNTICO"]
          S1[EmbeddingService<br/>+ Contexto]:::fixed
          S2[Similaridade<br/>Sem√¢ntica]:::fixed
          S3[Extra√ß√£o de<br/>Triplas Reais]:::fixed
      end

      %% ETAPA 4: ORGANIZA√á√ÉO
      subgraph E4["üìÅ ETAPA 4: QDRANT"]
          Q1[Threshold 0 para<br/>Categorizados]:::fixed
          Q2[Embeddings<br/>Enriquecidos]:::fixed
          Q3[Base Vetorial<br/>Validada]:::fixed
      end

      %% SISTEMA DE FEEDBACK
      subgraph FB["‚ôªÔ∏è FEEDBACK LOOP"]
          F1[Aprendizado<br/>Cont√≠nuo]:::feedback
          F2[Ajuste de<br/>Embeddings]:::feedback
          F3[Melhoria de<br/>Relev√¢ncia]:::feedback
      end

      %% FLUXO PRINCIPAL
      D1 --> D2 --> D3
      D3 --> P1
      P1 --> P2 --> P3

      %% CURADORIA PARALELA
      P3 --> C1
      C1 --> C2
      C2 --> C3
      C3 -.->|Boost| D2

      %% FLUXO PARA IA
      P3 --> A1
      C2 --> A3
      A1 --> A2
      A2 --> A3

      %% SISTEMA SEM√ÇNTICO
      A3 --> S1
      P2 -.->|Segmentos| S1
      C2 -.->|Valida√ß√£o| S2
      S1 --> S2
      S2 --> S3

      %% PARA QDRANT
      S3 --> Q1
      C1 -.->|Threshold 0| Q1
      Q1 --> Q2
      Q2 --> Q3

      %% FEEDBACK LOOPS
      Q3 --> F1
      F1 --> F2
      F2 --> F3
      F3 -.->|Ajusta| S1
      F3 -.->|Melhora| D2
      A3 -.->|Retroalimenta| F1

      %% INDICADORES DE CORRE√á√ÉO
      D2 -.- N1{{"‚úÖ Relev√¢ncia passa<br/>para IA"}}
      C2 -.- N2{{"‚úÖ Categorias como<br/>Ground Truth"}}
      P2 -.- N3{{"‚úÖ Preview<br/>Estruturado"}}
      S3 -.- N4{{"‚úÖ Embeddings<br/>Sem√¢nticos"}}
      F1 -.- N5{{"‚úÖ Sistema<br/>Aprende"}}
      
```

## üîÑ PIPELINE SEM√ÇNTICO COM SCHEMA.ORG
### Semantico com Schema.org
```mermaid

  graph TB
      %% Estilos
      classDef human fill:#f59e0b,stroke:#d97706,color:#fff
      classDef schema fill:#8b5cf6,stroke:#7c3aed,color:#fff
      classDef semantic fill:#10b981,stroke:#059669,color:#fff
      classDef cache fill:#3b82f6,stroke:#2563eb,color:#fff
      classDef hybrid fill:#ef4444,stroke:#dc2626,color:#fff
      classDef knowledge fill:#14b8a6,stroke:#0d9488,color:#fff

      %% ETAPA 1: DESCOBERTA E CURADORIA
      subgraph E1["üîç DESCOBERTA + CURADORIA HUMANA"]
          D1[Arquivos Descobertos]
          D2[Usu√°rio clica<br/>'Analisar com IA']:::human
          D3[Sistema detecta<br/>analysisType]:::human
          D4{{"5 Tipos de An√°lise<br/>‚Ä¢ Breakthrough T√©cnico<br/>‚Ä¢ Evolu√ß√£o Conceitual<br/>‚Ä¢ Momento Decisivo<br/>‚Ä¢ Insight Estrat√©gico<br/>‚Ä¢ Aprendizado Geral"}}:::human      
      end

      %% ETAPA 2: MAPEAMENTO SCHEMA.ORG
      subgraph E2["üîÆ TRANSFORMA√á√ÉO SCHEMA.ORG"]
          S1[SchemaOrgMapper]:::schema
          S2[["Mapeamento Sem√¢ntico<br/>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ<br/>Breakthrough ‚Üí TechArticle<br/>Evolu√ß√£o ‚Üí ScholarlyArticle<br/>Momento ‚Üí Event<br/>Insight ‚Üí
  Report<br/>Aprendizado ‚Üí Article"]]:::schema
          S3[Propriedades Ricas<br/>author, mentions,<br/>potentialAction,<br/>dependencies]:::schema
      end

      %% ETAPA 3: EXTRA√á√ÉO SEM√ÇNTICA
      subgraph E3["üß† EXTRA√á√ÉO DE ENTIDADES"]
          EX1[SchemaOrgExtractor]:::semantic
          EX2[Entidades Tipadas<br/>Person, Organization,<br/>Technology, Concept]:::semantic
          EX3[Rela√ß√µes Contextualizadas<br/>isBasedOn, mentions,<br/>teaches, requires]:::semantic
          EX4[Embeddings Enriquecidos<br/>com Contexto Schema.org]:::semantic
      end

      %% SISTEMA H√çBRIDO
      subgraph SH["‚ö° SISTEMA H√çBRIDO"]
          H1{Query Router}:::hybrid
          H2["Regex Engine<br/>15-50ms<br/>65% precis√£o"]:::hybrid
          H3["Schema.org Engine<br/>8-15ms (cached)<br/>89% precis√£o"]:::hybrid
          H4[["Cache 3 Camadas<br/>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ<br/>L1: Mem√≥ria<br/>L2: IndexedDB<br/>L3: Redis"]]:::cache
      end

      %% ETAPA 4: INDEXA√á√ÉO E BUSCA
      subgraph E4["üìä QDRANT + QUERIES SEM√ÇNTICAS"]
          Q1[√çndices Schema.org<br/>@type, author.name,<br/>mentions.technology]:::semantic
          Q2[["Queries Imposs√≠veis Antes<br/>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ<br/>'TechArticles sobre Redis<br/>com potentialAction'<br/><br/>'Events de 2024 com<br/>result
  positivo'"]]:::semantic
          Q3[Resultados Rankeados<br/>por Relev√¢ncia Sem√¢ntica]:::semantic
      end

      %% ETAPA 5: GRAFO DE CONHECIMENTO
      subgraph E5["üåê GRAFO DE CONHECIMENTO REAL"]
          G1[Clusters por @type]:::knowledge
          G2[Entidades Interconectadas]:::knowledge
          G3[Navega√ß√£o Sem√¢ntica<br/>n√£o apenas visual]:::knowledge
          G4[Export JSON-LD<br/>Interoper√°vel]:::knowledge
      end

      %% FLUXO PRINCIPAL
      D1 --> D2 --> D3 --> D4
      D4 --> S1
      S1 --> S2 --> S3
      S3 --> EX1
      EX1 --> EX2
      EX2 --> EX3
      EX3 --> EX4

      %% ROTEAMENTO H√çBRIDO
      EX4 --> H1
      H1 -->|"Simples"| H2
      H1 -->|"Complexa"| H3
      H2 --> H4
      H3 --> H4
      H4 --> Q1

      %% INDEXA√á√ÉO E VISUALIZA√á√ÉO
      Q1 --> Q2 --> Q3
      Q3 --> G1 --> G2 --> G3 --> G4

      %% FEEDBACK LOOPS
      G4 -.->|"Aprendizado"| S1
      Q3 -.->|"M√©tricas"| H1
      EX4 -.->|"Ground Truth"| S2

      %% DESTAQUES DE TRANSFORMA√á√ÉO
      D4 -.- T1{{"üîÑ TRANSFORMA√á√ÉO 1<br/>Curadoria humana<br/>vira marca de<br/>qualidade sem√¢ntica"}}
      S2 -.- T2{{"üîÑ TRANSFORMA√á√ÉO 2<br/>Types gen√©ricos viram<br/>ontologia Schema.org<br/>padronizada"}}
      EX3 -.- T3{{"üîÑ TRANSFORMA√á√ÉO 3<br/>Regex patterns viram<br/>entidades e rela√ß√µes<br/>estruturadas"}}
      Q2 -.- T4{{"üîÑ TRANSFORMA√á√ÉO 4<br/>Busca por palavras<br/>vira queries<br/>sem√¢nticas ricas"}}
      G3 -.- T5{{"üîÑ TRANSFORMA√á√ÉO 5<br/>Visualiza√ß√£o est√°tica<br/>vira grafo naveg√°vel<br/>de conhecimento"}}
```

## ‚óè üîÑ PIPELINE SEM√ÇNTICO
###  CICLO DE REFINAMENTO REGEX + CURADORIA + SCHEMA.ORG

```mermaid
  graph TB
      %% Estilos
      classDef initial fill:#fbbf24,stroke:#f59e0b,color:#000
      classDef human fill:#f59e0b,stroke:#d97706,color:#fff
      classDef refined fill:#10b981,stroke:#059669,color:#fff
      classDef schema fill:#8b5cf6,stroke:#7c3aed,color:#fff
      classDef converged fill:#14b8a6,stroke:#0d9488,color:#fff
      classDef metric fill:#ef4444,stroke:#dc2626,color:#fff

      %% DESCOBERTA E AN√ÅLISE INICIAL
      subgraph INICIAL["üìä AN√ÅLISE INICIAL (v1)"]
          I1[Arquivo Descoberto]
          I2[Clique 'Analisar com IA']:::initial
          I3[["analysisType Autom√°tico<br/>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ<br/>Confian√ßa: 65%<br/>Pode ser impreciso"]]:::initial
          I4[Schema.org Tentativo<br/>TechArticle?]:::initial
      end

      %% CURADORIA HUMANA
      subgraph CURADORIA["üë§ CURADORIA HUMANA"]
          C1[Usu√°rio avalia resultado]:::human
          C2{Adiciona Categorias<br/>Manuais}:::human
          C3[["Categorias como<br/>Ground Truth<br/>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ<br/>‚Ä¢ Estrat√©gia<br/>‚Ä¢ IA/ML<br/>‚Ä¢ Decis√µes"]]:::human
          C4[Clique 'Analisar<br/>com IA' NOVAMENTE]:::human
      end

      %% AN√ÅLISE REFINADA
      subgraph REFINADA["üéØ AN√ÅLISE REFINADA (v2+)"]
          R1[["Contexto Enriquecido<br/>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ<br/>+ Categorias manuais<br/>+ Hist√≥rico v1<br/>+ Keywords inferidas<br/>+ Consulta QDRANT"]]:::refined
          R2[USA IA Embbeding<br/>para validar/ajustar]:::refined
          R3[["analysisType Refinado<br/>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ<br/>Confian√ßa: 92%<br/>Mais preciso"]]:::refined
          R4[Schema.org Validado<br/>StrategicDocument!]:::refined
      end

      %% CONVERG√äNCIA
      subgraph CONVERGENCIA["‚úÖ CONVERG√äNCIA"]
          CV1{Medir<br/>Converg√™ncia}:::converged
          CV2[["Score Converg√™ncia<br/>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ<br/>typeStability: 1.0<br/>confidenceDelta: 0.92<br/>schemaStability: 1.0"]]:::converged
          CV3{Convergiu?<br/>>85%}:::converged
          CV4[analysisType<br/>DEFINITIVO]:::converged
          CV5[Schema.org<br/>ESTABELECIDO]:::converged
      end

      %% M√âTRICAS E HIST√ìRICO
      subgraph METRICAS["üìà M√âTRICAS DO CICLO"]
          M1[["Hist√≥rico de An√°lises<br/>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ<br/>v1: Breakthrough (65%)<br/>v2: Insight (85%)<br/>v3: Insight (92%)<br/>‚úì Convergido"]]:::metric
          M2[M√©dia: 2.3 itera√ß√µes<br/>para convergir]:::metric
          M3[Ganho: +27%<br/>confian√ßa]:::metric
      end

      %% INTEGRA√á√ÉO SCHEMA.ORG
      subgraph SCHEMA["üîÆ SCHEMA.ORG DEFINITIVO"]
          S1[SchemaOrgMapper<br/>Enriquecido]:::schema
          S2[["Entidade Final<br/>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ<br/>@type: StrategicDocument<br/>confidence: 0.92<br/>categories: [3]<br/>iterations: 3"]]:::schema
          S3[Propriedades Validadas<br/>por Curadoria]:::schema
      end

      %% FLUXO PRINCIPAL
      I1 --> I2 --> I3 --> I4
      I4 --> C1
      C1 --> C2 --> C3 --> C4
      C4 --> R1
      R1 --> R2 --> R3 --> R4
      R4 --> CV1
      CV1 --> CV2 --> CV3

      %% LOOP DE REFINAMENTO
      CV3 -->|"N√ÉO<br/><85%"| C1
      CV3 -->|"SIM<br/>‚â•85%"| CV4
      CV4 --> CV5
      CV5 --> S1
      S1 --> S2 --> S3

      %% M√âTRICAS PARALELAS
      I3 -.-> M1
      R3 -.-> M1
      CV2 -.-> M1
      M1 --> M2 --> M3

      %% DESTAQUES
      C3 -.- D1{{"üí° INSIGHT CHAVE<br/>Categorias manuais<br/>viram contexto rico<br/>para re-an√°lise"}}
      R2 -.- D2{{"üîÑ REFINAMENTO<br/>IA aprende com<br/>curadoria humana<br/>e melhora precis√£o"}}
      CV3 -.- D3{{"üìä CONVERG√äNCIA<br/>Sistema detecta quando<br/>an√°lise estabilizou<br/>(m√©dia 2-3 itera√ß√µes)"}}
      S2 -.- D4{{"‚ú® RESULTADO<br/>Schema.org definitivo<br/>validado por humano<br/>e m√°quina"}}
```